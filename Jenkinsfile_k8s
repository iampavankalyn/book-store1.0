pipeline {
    agent any
    
    environment {
        msname = "${params.microservice}"
    }
    stages {
        stage('deploying to kubernetes'){
            steps{
                    sh '''
                    cd ${msname}
                    kubectl get deployment | grep -q "^${msname} " || kubectl apply -f ${msname}.yaml
                    '''
            }
        }
    }
}
